<UserControl x:Class="AgendaDashboard.GcalView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:AgendaDashboard">
    <UserControl.Resources>
        <local:OrBooleanToVisibilityConverter x:Key="RefreshButtonVisibility" />
    </UserControl.Resources>
    <Grid>
        <ScrollViewer x:Name="ScrollViewer" VerticalScrollBarVisibility="Visible">
            <ItemsControl ItemsSource="{Binding GcalEvents}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <local:GcalPanel Height="1600" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Background="{Binding CalendarColor}" CornerRadius="4" Margin="2" Padding="4"
                                BorderBrush="Black" BorderThickness="0.5" HorizontalAlignment="Stretch">
                            <StackPanel>
                                <TextBlock Text="{Binding Title}" FontSize="10" FontWeight="Bold" TextTrimming="CharacterEllipsis" />
                                <TextBlock Text="{Binding CalendarName}" FontSize="8" Foreground="DimGray" TextTrimming="CharacterEllipsis" />
                                <TextBlock FontSize="8" TextTrimming="CharacterEllipsis">
                                    <Run Text="{Binding Start, StringFormat={}{0:HH:mm}}" />
                                    <Run Text=" - " />
                                    <Run Text="{Binding End, StringFormat={}{0:HH:mm}}" />
                                </TextBlock>
                            </StackPanel>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <Button x:Name="RefreshButton"
                HorizontalAlignment="Right"
                VerticalAlignment="Bottom"
                Margin="0,0,26,9"
                Click="RefreshButton_Click"
                Style="{StaticResource RefreshButton}">
            <Button.Visibility>
                <MultiBinding Converter="{StaticResource RefreshButtonVisibility}">
                    <Binding ElementName="ScrollViewer" Path="IsMouseOver" />
                    <Binding ElementName="RefreshButton" Path="IsMouseOver" />
                </MultiBinding>
            </Button.Visibility>
        </Button>
    </Grid>
</UserControl>